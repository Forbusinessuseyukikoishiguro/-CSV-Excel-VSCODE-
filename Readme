# Excel区切り文字変換ツール

Excelファイルを任意の区切り文字（タブ、カンマ、空白、セミコロン）のテキストファイルに変換するPython GUIツールです。

## 🌟 主な機能

- **複数ファイル形式対応**: Excel (.xlsx, .xls), CSV, テキストファイル
- **柔軟な区切り文字**: タブ、カンマ、空白、セミコロン
- **自動バックアップ**: 変換前に元ファイルを自動保護
- **プレビュー機能**: 変換結果を事前確認
- **強制テキスト読み込み**: 破損ファイルや特殊形式にも対応
- **復元機能**: バックアップからの簡単復元

## 📋 必要な環境

### Python バージョン
- Python 3.7 以上

### 必要なライブラリ
```bash
pip install pandas openpyxl xlrd
```

### ライブラリの詳細
- `pandas`: データ処理のメインライブラリ
- `openpyxl`: Excel 2007+ (.xlsx) ファイル読み込み用
- `xlrd`: Excel 97-2003 (.xls) ファイル読み込み用
- `tkinter`: GUI（Pythonに標準搭載）

## 🚀 インストール方法

### 1. Pythonの確認
```bash
python --version
```

### 2. 必要ライブラリのインストール
```bash
pip install pandas openpyxl xlrd
```

### 3. ツールのダウンロード
このREADMEと一緒に提供されている `excel_converter.py` をダウンロード

### 4. 実行
```bash
python excel_converter.py
```

## 📖 使用方法

### 基本的な使い方

1. **ツールを起動**
   ```bash
   python excel_converter.py
   ```

2. **入力ファイルを選択**
   - 「参照」ボタンでファイルを選択
   - Excel, CSV, テキストファイルに対応

3. **出力設定**
   - 出力ファイル名は自動生成（手動変更も可能）
   - バックアップ設定を確認

4. **区切り文字を選択**
   - **タブ**: TSV形式、最も一般的
   - **カンマ**: CSV形式
   - **空白**: スペース区切り
   - **セミコロン**: ヨーロッパ式CSV

5. **プレビューで確認**
   - 「プレビュー」ボタンで結果を事前確認
   - タブ区切りは「→」で視覚化

6. **変換実行**
   - 「変換実行」ボタンで処理開始
   - 自動でバックアップ作成

### トラブルシューティング機能

#### ファイル読み込みエラーの場合
1. **「テキストファイルとして強制読み込み」** をチェック
2. 複数のエンコーディングと区切り文字を自動試行
3. 大抵のファイルはこれで読み込み可能

#### バックアップと復元
- **自動バックアップ**: 変換前に `backup/` フォルダに自動保存
- **手動復元**: 「バックアップ復元」ボタンで過去ファイルを復元

## 🔧 高度な設定

### バックアップ設定
- **自動バックアップ**: デフォルトで有効
- **命名規則**: `元ファイル名_backup_20250910_143022.xlsx`
- **保存場所**: 元ファイルと同じフォルダ内の `backup/` サブフォルダ

### ファイル形式の自動判定
ツールは以下の順序でファイル形式を判定：
1. ファイルヘッダーの解析
2. 拡張子による判定
3. 複数エンコーディングでの試行読み込み

## 📁 ファイル構成

```
project/
├── excel_converter.py    # メインツール
├── README.md            # このファイル
└── backup/              # バックアップフォルダ（自動作成）
    ├── file1_backup_20250910_143022.xlsx
    └── file2_backup_20250910_144511.csv
```

## 💡 使用例

### Excel → タブ区切りテキスト
```
入力: sales_data.xlsx
出力: sales_data_tab.txt

A列    B列    C列
データ1    データ2    データ3
データ4    データ5    データ6
```

### Excel → CSV
```
入力: report.xlsx
出力: report_comma.csv

A列,B列,C列
データ1,データ2,データ3
データ4,データ5,データ6
```

## ⚠️ トラブルシューティング

### よくあるエラーと対処法

#### 1. "File is not a zip file"
**原因**: ファイルが破損しているか、実際にはExcel形式ではない
**対処法**: 
- 「テキストファイルとして強制読み込み」をチェック
- Excelで開いて再保存

#### 2. "Missing optional dependency 'xlrd'"
**原因**: xlrdライブラリ未インストール
**対処法**: 
```bash
pip install xlrd openpyxl
```

#### 3. ファイルが開けない
**対処法**: 
1. ファイルがExcelで開かれていないか確認
2. 読み取り専用属性を解除
3. 管理者権限でツールを実行

### 文字化け対策
- UTF-8-SIG エンコーディングで保存
- 日本語ファイル名・内容に対応
- Shift_JIS ファイルも自動検出

## 🎯 推奨ワークフロー

### データ分析用途
1. **Excel → タブ区切り** で保存
2. **VSCode** や **R** / **Python** で読み込み
3. データ分析実行

### システム連携用途
1. **Excel → CSV** で保存
2. 他システムにインポート

### バックアップ運用
1. 重要ファイルは必ずバックアップ有効
2. 定期的に `backup/` フォルダを確認
3. 必要に応じて復元機能を活用


### よくある質問
- **Q**: 大きなファイルも処理できますか？
- **A**: はい、Pandasが処理できるサイズまで対応しています。

- **Q**: 複数シートのExcelファイルは？
- **A**: 最初のシートのみ処理されます。

- **Q**: 数式が含まれるExcelファイルは？
- **A**: 計算結果の値が出力されます。

### パフォーマンス
- **小規模ファイル** (1,000行以下): 瞬時
- **中規模ファイル** (10,000行): 数秒
- **大規模ファイル** (100,000行+): 数十秒

## 🔄 更新履歴

### v1.0.0 (2025-09-10)
- 初回リリース
- 基本的な区切り文字変換機能
- バックアップ機能
- プレビュー機能
- 強制テキスト読み込み機能

## 📄 ライセンス

このツールは自由に使用・改変Ok

## 🤝 貢献

バグ報告や機能要望がございましたら、お気軽にお知らせください。

---

**開発者より**: このツールがあなたのデータ処理作業を効率化できれば幸いです！
